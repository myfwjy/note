---
title: 其他
tags: 新建,模板,小书匠
grammar_cjkRuby: true
---

### ThreadLocal
以线程为作用域维护变量。用于线程间的数据隔离，为每一个使用该变量的线程提供一个副本，每个线程都可以独立地改变自己的副本，而不会和其他线程的副本冲突。比如安卓中的handler机制。
ThreadLocal类中维护一个Map，用于存储每一个线程的变量副本，Map中元素的键为线程对象，而值为对应线程的变量副本。
Synchronized是利用锁的机制，使变量或代码块在某一时该只能被一个线程访问，用于在多个线程间通信时能够获得数据共享。 
### Synchronized  Lock Volatite
Synchronized是悲观锁机制，独占锁。而Locks.ReentrantLock是，每次不加锁而是假设没有冲突而去完成某项操作，如果因为冲突失败就重试，直到成功为止。
公平锁：按顺序获取锁，如果已经获取锁的线程再次申请，state状态加1，只有在state等于0时才释放锁。
非公平锁:上一个使用者释放，下一个使用者唤醒时，如果有其他申请，可能插队。
https://blog.csdn.net/yanyan19880509/article/details/52345422
Volatite只能保证可见性，即变更立即写入内存，其他线程必须从主内存中获取，但是不能保证原子性，可能读取时阻塞，写入是值已经不是当初读取的了。
### string stringbuffer stringbuilder
string是不可改变的对象，每次修改时，实际上是创建了一个新的string。stringbuffer是可改变对象，是对一个对象的操作，线程安全。stringbuilder线程不安全。
### fail-fast
java集合(Collection)中的一种错误机制。当多个线程对同一个集合的内容进行操作时，就可能会产生fail-fast事件。 
例如：当某一个线程A通过iterator去遍历某集合的过程中，若该集合的内容被其他线程所改变了；那么线程A访问集合时，就会抛出ConcurrentModificationException异常，产生fail-fast事件。
### 装箱和拆箱
装箱，基本数据类型包装成对象类型。拆箱，对象类型转换成基本数据类型。
### 反射
反射机制是在运行状态中，对于任意一个类，都能够知道这个类的所有属性和方法；对于任意一个对象，都能够调用它的任意一个方法和属性；这种动态获取的信息以及动态调用对象的方法的功能称为java语言的反射机制。
泛型的本质是参数化类型，也就是操作的数据类型被指定为一个参数。例如，使用List的时候指定为List，有利于代码简单安全，将运行时错误提前到编译时错误。而java在运行中会去泛型化。
### string是不可变类
String是不可变的。
1、因为不可变，所以字符串池中才可以多个变量指向一个字符串，而不用保存多个相同的字符串，否则字符串改变了，指向他的变量也会改变。
2、创建时hashcode就确定，很适合作为hashmap的key。
3、自带线程安全，同一个字符串可以被多个线程共享。
### Spring Bean的作用域 Prototype Request
任何时候使用getBean，Prototype都会返回一个新对象，而在一个httpRequest中request只会返回一个相同对象。
HttpRequest scope
Mark mark1 = context.getBean("mark");
Mark mark2 = context.getBean("mark");
mark1 == mark2; //This will return true

Prototype scope

Mark mark1 = context.getBean("mark");
Mark mark2 = context.getBean("mark");
mark1 == mark2; //This will return false