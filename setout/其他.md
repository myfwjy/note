---
title: 其他
tags: 新建,模板,小书匠
grammar_cjkRuby: true
---

### ThreadLocal
以线程为作用域维护变量。用于线程间的数据隔离，为每一个使用该变量的线程提供一个副本，每个线程都可以独立地改变自己的副本，而不会和其他线程的副本冲突。比如安卓中的handler机制。
ThreadLocal类中维护一个Map，用于存储每一个线程的变量副本，Map中元素的键为线程对象，而值为对应线程的变量副本。
Synchronized是利用锁的机制，使变量或代码块在某一时该只能被一个线程访问，用于在多个线程间通信时能够获得数据共享。 
### Synchronized  Lock Volatite
Synchronized是悲观锁机制，独占锁。而Locks.ReentrantLock是，每次不加锁而是假设没有冲突而去完成某项操作，如果因为冲突失败就重试，直到成功为止。
公平锁：按顺序获取锁，如果已经获取锁的线程再次申请，state状态加1，只有在state等于0时才释放锁。
非公平锁:上一个使用者释放，下一个使用者唤醒时，如果有其他申请，可能插队。
https://blog.csdn.net/yanyan19880509/article/details/52345422
Volatite只能保证可见性，即变更立即写入内存，其他线程必须从主内存中获取，但是不能保证原子性，可能读取时阻塞，写入是值已经不是当初读取的了。