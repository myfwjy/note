---
title: IOC和DI
tags: 新建,模板,小书匠
grammar_cjkRuby: true
---

## Bean
Spring Bean是被实例的，组装的以及被Spring容器管理的Java对象。
Spring容器会自动完成bean的实例化。创建应用对象之间的协作关系的行为称为：装配（wiring）,这就是依赖注入的本质。

## DI(依赖注入)
使用一个对象a，需要new一个实例，而这个对象如果有个属性b，那么b也需要new出来，这就是a依赖b。而传入b，可以通过a的接口、构造函数、设置a的属性，这个过程叫做依赖注入。


## IOC（控制反转）
从前的设计思想，是我们需要调用一个对象就去主动创建他。而控制反转指的是，a依赖b，但只是调用b，不控制b的创建和销毁，把b的控制权交给a以外的容器处理。从以前的主动控制外部资源获取，到现在的容器帮我们查找及注入依赖对象，对象被动接收依赖对象，依赖对象的获取反转了。
随着DI的频繁使用，要实现IOC就会有很多重复的代码，那么就有人把实现IOC的代码打包成组件或框架，避免人们重复造轮子。实现IOC的组件或框架被称为IOC Container。
IOC最主要的是解耦和方便附加功能（AOP）。解耦体现在，不用在调用的地方new对象，部分属性的设置也可以交给配置文件处理，当我们修改依赖类的时候，也不需要修改大量的代码。AOP面向切面编程，帮助我们在运行时动态插入代码。


## 其他
### 为什么Spring中不能使用new一个实例
Spring首先会通过new方法创建一个对象，然后去完成属性的填充，而这种填充在外界看来是自动的。我们直接通过new方法创建对象时，是无法完成属性的自动填充的，因而内部属性值全为null。
### singleton prototype
bean对象默认是singleton类型。一般建议无状态的使用singleton，比如dao，有状态的使用prototype，比如controller。singleton类型每次在获取bean时使用的都是唯一对象，prototype类型每次在获取时使用的都是new的新实例。